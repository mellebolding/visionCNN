# ResNet18 ImageNet â€” DALI + Disk Cache Backend
#
# Combines disk-cached data (memmap) with DALI GPU augmentation.
# Images are cached at 256x256 on NVMe, then DALI applies RandomResizedCrop,
# flip, and optional color jitter entirely on GPU. Threaded prefetch overlaps
# memmap I/O with GPU compute for high utilization.
#
# First run will create the cache (~262 GB). Subsequent runs reuse it.
#
# Requirements: nvidia-dali-cuda120, ~262 GB disk for cache
#
# Usage:
#   ./scripts/launch_guppy.sh configs/resnet18_imagenet_dali_cached.yaml

experiment_name: resnet18_imagenet_dali_cached

model:
  name: resnet18
  num_classes: 1000

data:
  dataset: imagenet
  root: "<IMAGENET_ROOT>"
  img_size: 224
  cache_size: 256               # Resolution to cache at (larger = more crop diversity)
  backend: dali_cached

  # Set to true to enable brightness/contrast/saturation augmentation on GPU
  color_jitter: false
  # brightness: 0.4
  # contrast: 0.4
  # saturation: 0.4

  dali:
    prefetch_queue_depth: 4

training:
  epochs: 40
  batch_size: 1024
  lr: 0.256
  min_lr: 0.0
  weight_decay: 1e-4
  optimizer: sgd
  momentum: 0.9
  scheduler: cosine
  label_smoothing: 0.1
  use_amp: true
  compile: true
  sync_bn: false
  channels_last: true
  val_frequency: 5
  save_frequency: 5
  disable_progress_bar: false

logging:
  log_dir: logs

# Weights & Biases experiment tracking
wandb:
  enabled: true
  project: visionCNN
  tags: []
