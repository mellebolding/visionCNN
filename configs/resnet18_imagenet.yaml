# ResNet18 ImageNet Configuration
# Usage: 
#   Single GPU: python scripts/train.py --config configs/resnet18_imagenet.yaml
#   Multi-GPU:  ./scripts/launch_local.sh configs/resnet18_imagenet.yaml
#   Snellius:   sbatch scripts/launch_snellius.sh configs/resnet18_imagenet.yaml

experiment_name: resnet18_imagenet

# Model configuration
model:
  name: resnet18
  num_classes: 1000

# Data configuration
data:
  dataset: imagenet
  root: "<IMAGENET_ROOT>"  # Auto-resolved from machine config
  img_size: 224
  pin_memory: true
  persistent_workers: true       # CRITICAL: Avoids worker respawn overhead between epochs
  prefetch_factor: 4             # Buffer more batches for smoother pipeline
  # Standard ImageNet augmentation
  color_jitter: false
  color_jitter_brightness: 0.3
  color_jitter_contrast: 0.3
  color_jitter_saturation: 0.0
  color_jitter_hue: 0.0
  random_erasing: false               

  # Advanced augmentation (optional - enable for +1-2% accuracy)
  rand_augment: false
  rand_augment_n: 2                  # If enabled: 2 ops per image
  rand_augment_m: 9                  # If enabled: moderate magnitude
  auto_augment: false                # Not recommended (slower than RandAugment)

# Training configuration
training:
  epochs: 40
  batch_size: 640               # Per-GPU batch size - maximize GPU utilization and reduce sync overhead
  lr: 0.16                      # Scaled from 0.1 for batch_size=256 using linear scaling (640/400 â‰ˆ 1.6x)
  min_lr: 0.0
  weight_decay: 1e-4
  optimizer: sgd
  momentum: 0.9
  scheduler: cosine             # or use 'step' with milestones below
  label_smoothing: 0.1
  use_amp: true
  compile: true                
  sync_bn: false                 # Recommended for DDP with small per-GPU batch
  channels_last: true

  # Speed optimizations
  val_frequency: 5              # Run validation every N epochs (not every epoch)
  save_frequency: 5             # Save checkpoint every N epochs (always saves best + last)
  disable_progress_bar: false   # Set to true for ~2% speedup
  
  # For step scheduler (ImageNet classic recipe)
  # scheduler: step
  # step_size: 30
  # gamma: 0.1

# Logging configuration
logging:
  log_dir: logs

# Weights & Biases experiment tracking
wandb:
  enabled: true
  project: visionCNN
  entity: null        # uses default wandb entity
  tags: []
